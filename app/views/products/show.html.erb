<% if @product.present? %>
  <% content_for :title, "#{@product["title"]} | YDP" %>
<% else %>
  <% content_for :title, "Product Details | YDP" %>
<% end %>

<%= render "shared/navbar" %>

<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10 md:py-14 space-y-12">
  <% if @error.present? %>
    <div class="bg-white border border-red-200 text-red-600 px-6 py-4 rounded-2xl text-center shadow-sm">
      <p class="font-medium"><%= @error %></p>
      <p class="text-sm text-red-400 mt-1">Please return to the catalog and try again.</p>
      <div class="mt-6">
        <%= link_to "Back to Products", root_path, class: "inline-flex items-center gap-2 rounded-full bg-ink px-5 py-2 text-sm font-semibold text-white transition hover:bg-black" %>
      </div>
    </div>
  <% elsif @product.present? %>
    <nav aria-label="Breadcrumb" class="text-sm text-slate-500 flex items-center gap-2">
      <%= link_to "Home", root_path, class: "hover:text-ink transition" %>
      <span>/</span>
      <%= link_to @product["category"].to_s.titleize, root_path, class: "hover:text-ink transition" %>
      <span>/</span>
      <span class="text-ink font-medium"><%= truncate(@product["title"], length: 40) %></span>
    </nav>

    <div class="grid gap-10 lg:grid-cols-[minmax(0,1.1fr)_minmax(0,1fr)] items-start">
      <div class="space-y-6">
        <div class="group relative overflow-hidden rounded-3xl bg-white shadow-sm">
          <div class="aspect-[4/5] bg-mist flex items-center justify-center p-6">
            <img src="<%= @product["image"] %>" alt="<%= @product["title"] %>" class="h-full object-contain transition-transform duration-700 ease-out group-hover:scale-105">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4 text-sm">
          <div class="rounded-2xl bg-white p-5 shadow-sm border border-slate-100">
            <div class="flex items-center gap-3">
              <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-brand/20 text-ink">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15.59 14.37a5 5 0 1 0-7.18 0L12 17.94l3.59-3.57Zm4.16-6.14A9 9 0 1 1 4.25 8.24" />
                </svg>
              </span>
              <div>
                <p class="font-semibold text-ink">Easy Returns</p>
                <p class="text-xs text-slate-500">30-day hassle-free returns &amp; exchanges.</p>
              </div>
            </div>
          </div>
          <div class="rounded-2xl bg-white p-5 shadow-sm border border-slate-100">
            <div class="flex items-center gap-3">
              <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-brand/20 text-ink">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v18m9-9H3" />
                </svg>
              </span>
              <div>
                <p class="font-semibold text-ink">Add to Wishlist</p>
                <p class="text-xs text-slate-500">Save the looks you love for later.</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="space-y-8">
        <header class="space-y-3">
          <p class="uppercase text-xs tracking-[0.4em] font-semibold text-slate-500"><%= @product["category"].to_s.titleize %></p>
          <h1 class="text-3xl md:text-4xl font-semibold text-ink leading-tight"><%= @product["title"] %></h1>
          <p class="text-slate-500 leading-relaxed"><%= @product["description"] %></p>
        </header>

        <div class="flex flex-wrap items-center gap-4">
          <p class="text-3xl font-semibold text-ink"><%= number_to_currency(@product["price"], precision: 2) %></p>
          <span class="inline-flex items-center gap-2 rounded-full bg-brand/10 px-4 py-2 text-sm font-medium text-ink">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15l4.5-4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
            </svg>
            In stock &amp; ready to ship
          </span>
        </div>

        <div class="flex flex-wrap gap-3">
          <button type="button" class="inline-flex items-center justify-center rounded-full bg-brand px-8 py-3 text-base font-semibold text-ink shadow-lg shadow-brand/40 transition-transform duration-300 hover:-translate-y-0.5 hover:bg-brand-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-brand-dark">Add To Cart</button>
          <button type="button" class="inline-flex items-center justify-center gap-2 rounded-full border border-slate-300 px-8 py-3 text-base font-semibold text-ink/80 transition hover:border-ink hover:text-ink focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-ink">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6l3 3" />
            </svg>
            Quick Buy
          </button>
          <button type="button" class="inline-flex items-center justify-center gap-2 rounded-full border border-slate-300 px-8 py-3 text-base font-semibold text-ink/80 transition hover:border-ink hover:text-ink focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-ink">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.17 5.17a4.5 4.5 0 0 1 6.36 0L12 7.64l2.47-2.47a4.5 4.5 0 1 1 6.36 6.36L12 20.36l-8.83-8.83a4.5 4.5 0 0 1 0-6.36Z" />
            </svg>
            Add To Wishlist
          </button>
        </div>

        <div class="flex flex-wrap gap-3 text-xs uppercase tracking-[0.3em] text-slate-400">
          <span class="inline-flex items-center rounded-full bg-white px-4 py-2 shadow-sm">Quick Dry</span>
          <span class="inline-flex items-center rounded-full bg-white px-4 py-2 shadow-sm">Chemical Free</span>
          <span class="inline-flex items-center rounded-full bg-white px-4 py-2 shadow-sm">Machine Washable</span>
        </div>

        <div class="space-y-4">
          <details class="group rounded-2xl bg-white p-6 shadow-sm border border-slate-100" open>
            <summary class="flex items-center justify-between cursor-pointer text-base font-semibold text-ink">
              Product Details
              <svg class="w-5 h-5 transition-transform duration-300 group-open:rotate-180" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25 12 15.75l-7.5-7.5" />
              </svg>
            </summary>
            <div class="mt-4 space-y-2 text-sm text-slate-500 leading-relaxed">
              <p>Premium fabric blend designed for softness with a subtle drape. Tailored for movement and all-day comfort.</p>
              <p>Available in inclusive sizing with clean seams, hidden pockets, and a smoothing high-rise waistband.</p>
            </div>
          </details>
          <details class="group rounded-2xl bg-white p-6 shadow-sm border border-slate-100">
            <summary class="flex items-center justify-between cursor-pointer text-base font-semibold text-ink">
              Shipping &amp; Return
              <svg class="w-5 h-5 transition-transform duration-300 group-open:rotate-180" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25 12 15.75l-7.5-7.5" />
              </svg>
            </summary>
            <div class="mt-4 space-y-2 text-sm text-slate-500 leading-relaxed">
              <p>Free standard shipping on orders over $75. Express options available at checkout.</p>
              <p>Returns accepted within 30 days of delivery. Items must be unworn with original tags attached.</p>
            </div>
          </details>
          <details class="group rounded-2xl bg-white p-6 shadow-sm border border-slate-100">
            <summary class="flex items-center justify-between cursor-pointer text-base font-semibold text-ink">
              Care Instructions
              <svg class="w-5 h-5 transition-transform duration-300 group-open:rotate-180" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25 12 15.75l-7.5-7.5" />
              </svg>
            </summary>
            <div class="mt-4 space-y-2 text-sm text-slate-500 leading-relaxed">
              <p>Machine wash cold with similar colors. Lay flat to dry or tumble dry low. Cool iron if needed.</p>
              <p>To maintain the fabric's softness, avoid bleach and dry cleaning.</p>
            </div>
          </details>
        </div>
      </div>
    </div>
  <% else %>
    <div class="bg-white border border-slate-200 px-6 py-10 rounded-3xl text-center shadow-sm">
      <p class="text-lg font-medium text-ink">Product details are currently unavailable.</p>
      <p class="text-sm text-slate-500 mt-2">Please return to the collection to continue browsing.</p>
      <div class="mt-6">
        <%= link_to "Back to Products", root_path, class: "inline-flex items-center gap-2 rounded-full bg-ink px-5 py-2 text-sm font-semibold text-white transition hover:bg-black" %>
      </div>
    </div>
  <% end %>
</div>

<%= render "shared/loyalty_banner" %>
<%= render "shared/footer_links" %>
