<% if @product.present? %>
  <% content_for :title, "#{@product["title"]} | Supra Beach Volley" %>
<% else %>
  <% content_for :title, "Product Details | Supra Beach Volley" %>
<% end %>

<%= render "shared/navbar" %>

<div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10 md:py-16 space-y-12">
  <% if @error.present? %>
    <div class="bg-white border border-red-200 text-red-600 px-6 py-6 rounded-3xl text-center shadow-sm">
      <p class="font-medium"><%= @error %></p>
      <p class="text-sm text-red-400 mt-2" data-i18n data-i18n-en="Please return to the catalog and try again." data-i18n-th="โปรดกลับไปที่หน้ารวมสินค้าแล้วลองใหม่อีกครั้ง">Please return to the catalog and try again.</p>
      <div class="mt-6">
        <a href="<%= root_path %>" class="inline-flex items-center gap-2 rounded-full bg-ink px-5 py-2 text-sm font-semibold text-white transition hover:bg-black">
          <span aria-hidden="true">←</span>
          <span data-i18n data-i18n-en="Back to products" data-i18n-th="กลับไปหน้าสินค้า">Back to products</span>
        </a>
      </div>
    </div>
  <% elsif @product.present? %>
    <nav aria-label="Breadcrumb" class="text-sm text-slate-500 flex flex-wrap items-center gap-2">
      <a href="<%= root_path %>" class="hover:text-ink transition">
        <span data-i18n data-i18n-en="Home" data-i18n-th="หน้าแรก">Home</span>
      </a>
      <span>/</span>
      <%= link_to @product["category"].to_s.titleize, root_path(anchor: "collections"), class: "hover:text-ink transition" %>
      <span>/</span>
      <span class="text-ink font-medium"><%= truncate(@product["title"], length: 60) %></span>
    </nav>

    <div class="grid gap-10 lg:grid-cols-[minmax(0,1.05fr)_minmax(0,0.95fr)] items-start">
      <div class="space-y-6">
        <div class="group relative overflow-hidden rounded-[32px] bg-white shadow-glow border border-white/40">
          <div class="absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-surf via-brand to-sand"></div>
          <div class="aspect-[4/5] bg-surf/10 flex items-center justify-center p-6">
            <img src="<%= @product["image"] %>" alt="<%= @product["title"] %>" class="h-full object-contain transition-transform duration-700 ease-out group-hover:scale-105">
          </div>
        </div>
        <div class="grid gap-4 sm:grid-cols-2">
          <div class="rounded-2xl bg-white p-5 shadow-sm border border-surf/20">
            <div class="flex items-center gap-3">
              <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-brand/20 text-brand">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15.59 14.37a5 5 0 1 0-7.18 0L12 17.94l3.59-3.57Zm4.16-6.14A9 9 0 1 1 4.25 8.24" />
                </svg>
              </span>
              <div>
                <p class="font-semibold text-ink" data-i18n data-i18n-en="Coastal fit guarantee" data-i18n-th="รับประกันความพอดีชายหาด">Coastal fit guarantee</p>
                <p class="text-xs text-slate-500" data-i18n data-i18n-en="30-day returns and sandy play testing." data-i18n-th="คืนได้ใน 30 วัน พร้อมทดสอบในสนามทราย">30-day returns and sandy play testing.</p>
              </div>
            </div>
          </div>
          <div class="rounded-2xl bg-white p-5 shadow-sm border border-surf/20">
            <div class="flex items-center gap-3">
              <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-brand/20 text-brand">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6l3 3" />
                </svg>
              </span>
              <div>
                <p class="font-semibold text-ink" data-i18n data-i18n-en="Express checkout" data-i18n-th="ชำระด่วน">Express checkout</p>
                <p class="text-xs text-slate-500" data-i18n data-i18n-en="SupraPay, PromptPay, and Sand Wallet supported." data-i18n-th="รองรับ SupraPay พร้อมเพย์ และ Sand Wallet">SupraPay, PromptPay, and Sand Wallet supported.</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="space-y-8">
        <header class="space-y-3">
          <p class="uppercase text-xs tracking-[0.35em] font-semibold text-brand"><%= @product["category"].to_s.titleize %></p>
          <h1 class="text-3xl md:text-4xl font-semibold text-ink leading-tight"><%= @product["title"] %></h1>
          <p class="text-slate-500 leading-relaxed"><%= @product["description"] %></p>
        </header>

        <div class="flex flex-wrap items-center gap-4">
          <p class="text-3xl font-semibold text-ink"><%= number_to_currency(@product["price"], precision: 2) %></p>
          <span class="inline-flex items-center gap-2 rounded-full bg-brand/10 px-4 py-2 text-sm font-medium text-brand">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15l4.5-4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
            </svg>
            <span data-i18n data-i18n-en="In stock" data-i18n-th="มีของพร้อมส่ง">In stock</span>
          </span>
        </div>

        <div class="flex flex-wrap gap-3">
          <button type="button" class="inline-flex items-center justify-center rounded-full bg-brand px-8 py-3 text-base font-semibold text-white shadow-glow transition-transform duration-300 hover:-translate-y-0.5 hover:bg-brand-dark">
            <span data-i18n data-i18n-en="Add to cart" data-i18n-th="เพิ่มลงตะกร้า">Add to cart</span>
          </button>
          <button type="button" class="inline-flex items-center justify-center gap-2 rounded-full border border-slate-300 px-8 py-3 text-base font-semibold text-ink/80 transition hover:border-brand hover:text-brand">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.17 5.17a4.5 4.5 0 0 1 6.36 0L12 7.64l2.47-2.47a4.5 4.5 0 1 1 6.36 6.36L12 20.36l-8.83-8.83a4.5 4.5 0 0 1 0-6.36Z" />
            </svg>
            <span data-i18n data-i18n-en="Wishlist" data-i18n-th="บันทึก">Wishlist</span>
          </button>
          <button type="button" class="inline-flex items-center justify-center gap-2 rounded-full border border-slate-300 px-8 py-3 text-base font-semibold text-ink/80 transition hover:border-brand hover:text-brand" data-modal-trigger="topup-modal">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
            </svg>
            <span data-i18n data-i18n-en="Top up &amp; buy" data-i18n-th="เติมเงินแล้วซื้อ">Top up &amp; buy</span>
          </button>
        </div>

        <div class="flex flex-wrap gap-3 text-xs uppercase tracking-[0.3em] text-slate-400">
          <span class="inline-flex items-center rounded-full bg-white px-4 py-2 shadow-sm">UV Shield</span>
          <span class="inline-flex items-center rounded-full bg-white px-4 py-2 shadow-sm">Quick Dry</span>
          <span class="inline-flex items-center rounded-full bg-white px-4 py-2 shadow-sm">Thai Beach Ready</span>
        </div>

        <div class="space-y-4">
          <details class="group rounded-2xl bg-white p-6 shadow-sm border border-surf/20" open>
            <summary class="flex items-center justify-between cursor-pointer text-base font-semibold text-ink">
              <span data-i18n data-i18n-en="Product details" data-i18n-th="รายละเอียดสินค้า">Product details</span>
              <svg class="w-5 h-5 transition-transform duration-300 group-open:rotate-180" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25 12 15.75l-7.5-7.5" />
              </svg>
            </summary>
            <div class="mt-4 space-y-2 text-sm text-slate-500 leading-relaxed">
              <p data-i18n data-i18n-en="Premium fabric blend engineered for tropical heat with ventilated mesh zones." data-i18n-th="ผ้าพรีเมียมระบายอากาศ รองรับอากาศร้อนชื้นพร้อมช่องตาข่าย">Premium fabric blend engineered for tropical heat with ventilated mesh zones.</p>
              <p data-i18n data-i18n-en="Anti-slip grip panels keep your sets precise even with sand and sweat." data-i18n-th="แผ่นกันลื่นช่วยให้การเล่นแม่นยำ แม้มือมีทรายหรือเหงื่อ">Anti-slip grip panels keep your sets precise even with sand and sweat.</p>
            </div>
          </details>
          <details class="group rounded-2xl bg-white p-6 shadow-sm border border-surf/20">
            <summary class="flex items-center justify-between cursor-pointer text-base font-semibold text-ink">
              <span data-i18n data-i18n-en="Shipping &amp; return" data-i18n-th="การจัดส่งและคืนสินค้า">Shipping &amp; return</span>
              <svg class="w-5 h-5 transition-transform duration-300 group-open:rotate-180" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25 12 15.75l-7.5-7.5" />
              </svg>
            </summary>
            <div class="mt-4 space-y-2 text-sm text-slate-500 leading-relaxed">
              <p data-i18n data-i18n-en="Free shipping nationwide over ฿999. Same-day drop in Bangkok sands." data-i18n-th="จัดส่งฟรีทั่วไทยเมื่อสั่งเกิน 999 บาท ส่งด่วนในกรุงเทพฯ วันเดียวถึง">Free shipping nationwide over ฿999. Same-day drop in Bangkok sands.</p>
              <p data-i18n data-i18n-en="Returns accepted within 30 days. LINE OA crew support for quick swaps." data-i18n-th="คืนได้ภายใน 30 วัน มีทีม LINE OA ช่วยดูแล">Returns accepted within 30 days. LINE OA crew support for quick swaps.</p>
            </div>
          </details>
          <details class="group rounded-2xl bg-white p-6 shadow-sm border border-surf/20">
            <summary class="flex items-center justify-between cursor-pointer text-base font-semibold text-ink">
              <span data-i18n data-i18n-en="Care instructions" data-i18n-th="วิธีดูแล">Care instructions</span>
              <svg class="w-5 h-5 transition-transform duration-300 group-open:rotate-180" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25 12 15.75l-7.5-7.5" />
              </svg>
            </summary>
            <div class="mt-4 space-y-2 text-sm text-slate-500 leading-relaxed">
              <p data-i18n data-i18n-en="Rinse saltwater gently, machine wash cold, hang in shade." data-i18n-th="ล้างน้ำทะเลออกเบาๆ ซักเครื่องน้ำเย็น ตากในที่ร่ม">Rinse saltwater gently, machine wash cold, hang in shade.</p>
              <p data-i18n data-i18n-en="Avoid bleach, tumble dry low or air dry for best feel." data-i18n-th="หลีกเลี่ยงสารฟอกขาว อบลมเบา หรือผึ่งลมจะดีที่สุด">Avoid bleach, tumble dry low or air dry for best feel.</p>
            </div>
          </details>
        </div>

        <div id="ai-concierge" class="rounded-3xl border border-brand/30 bg-brand/10 p-6 shadow-sm space-y-4">
          <h2 class="text-xl font-semibold text-ink" data-i18n data-i18n-en="Need advice?" data-i18n-th="ต้องการคำแนะนำ?">Need advice?</h2>
          <p class="text-sm text-slate-500" data-i18n data-i18n-en="Chat with Supra Coastline AI for Thai or English gear tips." data-i18n-th="คุยกับ Supra Coastline AI ได้ทั้งไทยและอังกฤษเพื่อรับคำแนะนำเรื่องอุปกรณ์">Chat with Supra Coastline AI for Thai or English gear tips.</p>
          <a href="#ai-concierge" class="inline-flex items-center gap-2 rounded-full bg-white px-5 py-3 text-sm font-semibold text-brand border border-brand/40 hover:bg-brand hover:text-white transition">
            <span data-i18n data-i18n-en="Open AI chat" data-i18n-th="เปิดแชท AI">Open AI chat</span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="m9 5 7 7-7 7" />
            </svg>
          </a>
        </div>
      </div>
    </div>
  <% end %>
</div>
